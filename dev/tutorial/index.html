<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · JuMagDocs.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>JuMagDocs.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">JuMag.jl</a></li><li class="current"><a class="toctext" href>Tutorial</a><ul class="internal"><li><a class="toctext" href="#An-example-–-vortex-1">An example – vortex</a></li><li><a class="toctext" href="#How-to-enable-GPU-1">How to enable GPU</a></li></ul></li><li><a class="toctext" href="../equations/">Implemented equations</a></li><li><a class="toctext" href="../notes/">Notes</a></li><li><a class="toctext" href="../functions/">Function reference</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Tutorial</a></li></ul><a class="edit-page" href="https://github.com/ww1g11/JuMagDocs.jl/blob/master/docs/src/tutorial.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Tutorial</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Tutorial-1" href="#Tutorial-1">Tutorial</a></h1><h2><a class="nav-anchor" id="An-example-–-vortex-1" href="#An-example-–-vortex-1">An example – vortex</a></h2><p>To start a micromagnetic simulation, we first create a FDMesh</p><pre><code class="language-julia">mesh = FDMesh(dx=2e-9, dy=2e-9, dz=2e-9, nx=100, ny=100)</code></pre><p>After that, we create a simulation</p><pre><code class="language-julia">sim = Sim(mesh, name=&quot;vortex&quot;)</code></pre><p>and set the damping to 0.5 and switch off the precession term in LLG equation:</p><pre><code class="language-julia">sim.driver.alpha = 0.5
sim.driver.precession = false</code></pre><p>The geometry of the system can be defined by</p><pre><code class="language-julia">set_Ms(sim, circular_Ms)</code></pre><p>where <code>circular_Ms</code> could be a scalar or a function. The function should take six parameters <code>(i,j,k,dx,dy,dz)</code>, for instance</p><pre><code class="language-julia">function circular_Ms(i,j,k,dx,dy,dz)
    if (i-50.5)^2 + (j-50.5)^2 &lt;= 50^2
        return 8.6e5
    end
    return 0.0
end</code></pre><p>We add the exchange interaction and the demagnetization field to the system.</p><pre><code class="language-julia">add_exch(sim, 1.3e-11)
add_demag(sim)</code></pre><p>We need to initialise the system which can be done by defining a function</p><pre><code class="language-julia">function init_fun(i,j,k,dx,dy,dz)
  x = i-50.5
  y = j-50.5
  r = (x^2+y^2)^0.5
  if r&lt;5
    return (0,0,1)
  end
  return (y/r, -x/r, 0)
end</code></pre><p>and using</p><pre><code class="language-julia">init_m0(sim, init_fun)</code></pre><p>To trigger the simulation we relax the system</p><pre><code class="language-julia">relax(sim, maxsteps=1000)</code></pre><h2><a class="nav-anchor" id="How-to-enable-GPU-1" href="#How-to-enable-GPU-1">How to enable GPU</a></h2><p>Using FDMeshGPU instead of FDMesh to switch on the GPU calculation,</p><pre><code class="language-julia">mesh = FDMeshGPU(dx=2e-9, dy=2e-9, dz=2e-9, nx=100, ny=100)</code></pre><p>The script to use GPU to obtain the vortex structure is shown below:</p><pre><code class="language-julia">using JuMag
using Printf
using NPZ

JuMag.cuda_using_double(true)
mesh =  FDMeshGPU(dx=2e-9, dy=2e-9, dz=5e-9, nx=100, ny=100, nz=4)

function circular_Ms(i,j,k,dx,dy,dz)
    x = i-50.5
    y = j-50.5
    r = (x^2+y^2)^0.5
    if (i-50.5)^2 + (j-50.5)^2 &lt;= 50^2
        return 8e5
    end
    return 0.0
end

function init_fun(i,j,k,dx,dy,dz)
  x = i-50.5
  y = j-50.5
  r = (x^2+y^2)^0.5
  if r&lt;5
    return (0,0,1)
  end
  return (y/r, -x/r, 0)
end

function relax_system()
  sim = Sim(mesh, driver=&quot;SD&quot;, name=&quot;sim&quot;)
  set_Ms(sim, circular_Ms)

  add_exch(sim, 1.3e-11, name=&quot;exch&quot;)
  add_demag(sim)

  init_m0(sim, init_fun)
  relax(sim, maxsteps=2000, stopping_torque=1.0, save_vtk_every = 100, save_m_every=-1)
  npzwrite(&quot;m0.npy&quot;, sim.spin)
end

relax_system()</code></pre><p>##Standard Problem #4</p><pre><code class="language-julia">using JuMag
using Printf
using NPZ

mesh =  FDMeshGPU(nx=200, ny=50, nz=1, dx=2.5e-9, dy=2.5e-9, dz=3e-9)

function relax_system(mesh)
  sim = Sim(mesh, name=&quot;std4_relax&quot;, driver=&quot;SD&quot;)
  set_Ms(sim, 8.0e5)
  sim.driver.min_tau = 1e-10

  add_exch(sim, 1.3e-11)
  add_demag(sim)

  init_m0(sim, (1, 0.25, 0.1))

  relax(sim, maxsteps=5000, stopping_torque=10.0)
  npzwrite(&quot;m0.npy&quot;, Array(sim.spin))
end

function apply_field1(mesh)
  sim = Sim(mesh, name=&quot;std4_dyn&quot;)
  set_Ms(sim, 8.0e5)
  sim.driver.alpha = 0.02
  sim.driver.gamma = 2.211e5

  mT = 0.001 / (4*pi*1e-7)
  add_exch(sim, 1.3e-11)
  add_demag(sim)
  add_zeeman(sim, (-24.6*mT, 4.3*mT, 0))

  init_m0(sim, npzread(&quot;m0.npy&quot;))

  for i=1:100
    run_until(sim, 1e-11*i)
  end
end

relax_system(mesh)
println(&quot;Start step2 !!!&quot;)
apply_field1(mesh)
println(&quot;Run step2 again!!!&quot;)
@time apply_field1(mesh)
println(&quot;Done!&quot;)</code></pre><p>The output file is a simple text compatible with <a href="http://www.gnuplot.info/">Gnuplot</a>, like used for plot below.</p><p><img src="../scripts/std4.png" alt="std4"/></p><footer><hr/><a class="previous" href="../"><span class="direction">Previous</span><span class="title">JuMag.jl</span></a><a class="next" href="../equations/"><span class="direction">Next</span><span class="title">Implemented equations</span></a></footer></article></body></html>
